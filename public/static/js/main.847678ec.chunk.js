(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{1:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"k",function(){return a}),n.d(t,"e",function(){return c}),n.d(t,"f",function(){return o}),n.d(t,"d",function(){return u}),n.d(t,"h",function(){return s}),n.d(t,"j",function(){return l}),n.d(t,"i",function(){return i}),n.d(t,"c",function(){return p}),n.d(t,"b",function(){return d}),n.d(t,"l",function(){return m}),n.d(t,"m",function(){return f}),n.d(t,"g",function(){return h});var r="APP_LOAD",a="REDIRECT",c="HOME_PAGE_LOADED",o="HOME_PAGE_UNLOADED",u="CHANGE_TAB",s="LOGIN",l="LOGOUT",i="LOGIN_PAGE_UNLOADED",p="ASYNC_START",d="ASYNC_END",m="UPDATE_FIELD_AUTH",f="VESSEL_PAGE_LOADED",h="LOAD_CERTIFICATES"},14:function(e,t,n){"use strict";(function(e){var r=n(35),a=n.n(r),c=n(36),o=n.n(c),u=a()(o.a,e.Promise),s="http://localhost:8081/api",l="http://localhost:8081/api",i=function(e){return e.body},p=null,d=function(e){p&&e.set("Authorization","Bearer ".concat(p))},m=function(e){return u.get("".concat(l).concat(e)).use(d).then(i)},f=function(e,t){return u.put("".concat(l).concat(e),t).use(d).then(i)},h=function(e,t){return u.post("".concat(l).concat(e),t).use(d).then(i)},v=function(e){return u.get("".concat(s).concat(e)).use(d).then(i)},b={current:function(){return m("/v1/user")},login:function(e){return h("/v1/auth",{token:e})},register:function(e,t,n){return h("/users",{user:{username:e,email:t,password:n}})},save:function(e){return f("/user",{user:e})}},E={all:function(){return v("/vessels")},get:function(e){return v("/vessels/".concat(e))}},y={byVessel:function(e){return v("/vessels/".concat(e,"/certificates"))}};t.a={Auth:b,Vessels:E,Certificates:y,setToken:function(e){p=e}}}).call(this,n(16))},38:function(e,t,n){e.exports=n(58)},58:function(e,t,n){"use strict";n.r(t);var r=n(24),a=n.n(r),c=n(13),o=n(0),u=n.n(o),s=n(11),l=(n(47),n(34)),i=n(14),p=n(1),d=function(e){return function(t){return function(n){if((c=n.payload)&&"function"===typeof c.then){e.dispatch({type:p.c,subtype:n.type});var r=e.getState().viewChangeCounter,a=n.skipTracking;n.payload.then(function(t){var c=e.getState();(a||c.viewChangeCounter===r)&&(console.log("RESULT",t),n.payload=t,e.dispatch({type:p.b,promise:n.payload}),e.dispatch(n))},function(t){var c=e.getState();(a||c.viewChangeCounter===r)&&(console.log("ERROR",t),n.error=!0,n.payload=t.response.body,n.skipTracking||e.dispatch({type:p.b,promise:n.payload}),e.dispatch(n))})}else{var c;t(n)}}}},m=function(e){return function(e){return function(t){t.type===p.h?t.error||(window.localStorage.setItem("jwt",t.payload.user.token),i.a.setToken(t.payload.user.token)):t.type===p.j&&(window.localStorage.setItem("jwt",""),i.a.setToken(null)),e(t)}}};var f,h=n(5),v={appName:"Captain",token:null},b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case p.a:return Object(h.a)({},e,{token:t.token||null,appLoaded:!0,currentUser:t.payload?t.payload.user:null,redirectTo:t.token?null:"/login"});case p.k:return Object(h.a)({},e,{redirectTo:null});case p.h:return Object(h.a)({},e,{redirectTo:t.error?null:"/",token:t.error?null:t.payload.user.token,currentUser:t.error?null:t.payload.user});case p.j:return Object(h.a)({},e,{redirectTo:"/",token:null,currentUser:null});default:return e}},E=n(26),y={password:""},O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case p.i:return{};case p.h:return Object(h.a)({},e,{inProgress:!1,errors:t.error?t.payload.errors:null});case p.c:if(t.subtype===p.h)return Object(h.a)({},e,{inProgress:!0});break;case p.l:return Object(h.a)({},e,Object(E.a)({},t.key,t.value));default:return e}return e},g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case p.e:return Object(h.a)({},e,{vessels:t.payload[0]});case p.g:return Object(h.a)({},e,{vessel:t.payload[0],certificates:t.payload[1]});case p.f:return{};default:return e}},j=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case p.e:return Object(h.a)({},e,{vessels:t.payload[0]});case p.f:return{};default:return e}},k=n(15),N=n(32),T=n(8),w=Object(T.a)(),U=Object(N.a)(w),A=Object(s.createStore)((f=w,Object(s.combineReducers)({common:b,auth:O,home:g,vessels:j,router:Object(k.b)(f)})),Object(l.composeWithDevTools)(Object(s.applyMiddleware)(U,d,m))),L=n(9),C=n(19),D=n(20),S=n(22),_=n(21),P=n(23),R=n(12),I=u.a.memo(function(e){return e.currentUser?null:u.a.createElement("ul",{className:"nav navbar-nav pull-xs-right"},u.a.createElement("li",{className:"nav-item"},u.a.createElement(R.a,{to:"/",className:"nav-link"},"Home")),u.a.createElement("li",{className:"nav-item"},u.a.createElement(R.a,{to:"/login",className:"nav-link"},"Sign in")))}),G=u.a.memo(function(e){return e.currentUser?u.a.createElement("ul",{className:"nav navbar-nav pull-xs-right"},u.a.createElement("li",{className:"nav-item"},u.a.createElement(R.a,{to:"/",className:"nav-link"},"Home")),u.a.createElement("li",{className:"nav-item"},u.a.createElement(R.a,{to:"/@".concat(e.currentUser.username),className:"nav-link"},u.a.createElement("img",{src:e.currentUser.image,className:"user-pic",alt:e.currentUser.username}),"Welcome, ",e.currentUser.display_name))):null}),H=function(e){function t(){return Object(C.a)(this,t),Object(S.a)(this,Object(_.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(D.a)(t,[{key:"render",value:function(){return u.a.createElement("nav",{className:"navbar navbar-light"},u.a.createElement("div",{className:"container"},u.a.createElement(R.a,{to:"/",className:"navbar-brand"},this.props.appName.toLowerCase()),u.a.createElement(I,{currentUser:this.props.currentUser}),u.a.createElement(G,{currentUser:this.props.currentUser})))}}]),t}(u.a.PureComponent),x=n(4),z=Object(o.lazy)(function(){return n.e(0).then(n.bind(null,61))}),M=Object(o.lazy)(function(){return n.e(1).then(n.bind(null,63))}),B=Object(o.lazy)(function(){return n.e(2).then(n.bind(null,62))}),V=function(e){function t(){return Object(C.a)(this,t),Object(S.a)(this,Object(_.a)(t).apply(this,arguments))}return Object(P.a)(t,e),Object(D.a)(t,[{key:"componentDidUpdate",value:function(e){this.props.redirectTo&&this.props.redirectTo!==e.redirectTo&&(A.dispatch(Object(x.d)(this.props.redirectTo)),this.props.onRedirect())}},{key:"componentDidMount",value:function(){var e=window.localStorage.getItem("jwt");e&&i.a.setToken(e),this.props.onLoad(e?i.a.Auth.current():null,e)}},{key:"render",value:function(){return this.props.appLoaded?u.a.createElement("div",null,u.a.createElement(H,{appName:this.props.appName,currentUser:this.props.currentUser}),u.a.createElement(o.Suspense,{fallback:u.a.createElement("p",null,"Loading...")},u.a.createElement(L.c,null,u.a.createElement(L.a,{exact:!0,path:"/",component:z}),u.a.createElement(L.a,{path:"/login",component:M}),u.a.createElement(L.a,{path:"/vessel/:id",component:B})))):u.a.createElement("div",null,u.a.createElement(H,{appName:this.props.appName,currentUser:this.props.currentUser}))}}]),t}(u.a.PureComponent),F=Object(c.c)(function(e){return{appLoaded:e.common.appLoaded,appName:e.common.appName,currentUser:e.common.currentUser,redirectTo:e.common.redirectTo}},function(e){return{onLoad:function(t,n){return e({type:p.a,payload:t,token:n,skipTracking:!0})},onRedirect:function(){return e({type:p.k})}}})(V);a.a.render(u.a.createElement(c.a,{store:A},u.a.createElement(k.a,{history:w},u.a.createElement(L.c,null,u.a.createElement(L.a,{path:"/",component:F})))),document.getElementById("root"))}},[[38,4,5]],[1,2]]);
//# sourceMappingURL=main.847678ec.chunk.js.map
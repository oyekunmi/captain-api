(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{1:function(e,t,n){"use strict";n.d(t,"d",function(){return r}),n.d(t,"n",function(){return a}),n.d(t,"h",function(){return c}),n.d(t,"i",function(){return o}),n.d(t,"g",function(){return u}),n.d(t,"k",function(){return s}),n.d(t,"m",function(){return i}),n.d(t,"l",function(){return l}),n.d(t,"f",function(){return p}),n.d(t,"e",function(){return d}),n.d(t,"o",function(){return m}),n.d(t,"q",function(){return f}),n.d(t,"j",function(){return h}),n.d(t,"b",function(){return v}),n.d(t,"c",function(){return E}),n.d(t,"a",function(){return b}),n.d(t,"p",function(){return y});var r="APP_LOAD",a="REDIRECT",c="HOME_PAGE_LOADED",o="HOME_PAGE_UNLOADED",u="CHANGE_TAB",s="LOGIN",i="LOGOUT",l="LOGIN_PAGE_UNLOADED",p="ASYNC_START",d="ASYNC_END",m="UPDATE_FIELD_AUTH",f="VESSEL_PAGE_LOADED",h="LOAD_CERTIFICATES",v="ADD_CERTIFICATE_PAGE_LOADED",E="ADD_CERTIFICATE_PAGE_UNLOADED",b="ADD_CERTIFICATE",y="UPDATE_FIELD_CERTIFICATE"},14:function(e,t,n){"use strict";(function(e){var r=n(35),a=n.n(r),c=n(36),o=n.n(c),u=a()(o.a,e.Promise),s="https://captain.moovelogic.com/api",i="https://captain.moovelogic.com/api",l=function(e){return e.body},p=null,d=function(e){p&&e.set("Authorization","Bearer ".concat(p))},m=function(e){return u.get("".concat(s).concat(e)).use(d).then(l)},f=function(e,t){return u.put("".concat(s).concat(e),t).use(d).then(l)},h=function(e,t){return u.post("".concat(s).concat(e),t).use(d).then(l)},v=function(e){return u.get("".concat(i).concat(e)).use(d).then(l)},E={current:function(){return m("/v1/user")},login:function(e){return h("/v1/auth",{token:e})},register:function(e,t,n){return h("/users",{user:{username:e,email:t,password:n}})},save:function(e){return f("/user",{user:e})}},b={all:function(){return v("/vessels")},get:function(e){return v("/vessels/".concat(e))}},y={byVessel:function(e){return v("/vessels/".concat(e,"/certificates"))},save:function(e){return h("/vessels/".concat(e.vessel_id,"/certificates"),e)}};t.a={Auth:E,Vessels:b,Certificates:y,setToken:function(e){p=e}}}).call(this,n(17))},38:function(e,t,n){e.exports=n(58)},58:function(e,t,n){"use strict";n.r(t);var r=n(25),a=n.n(r),c=n(13),o=n(0),u=n.n(o),s=n(12),i=(n(47),n(34)),l=n(14),p=n(1),d=function(e){return function(t){return function(n){if((c=n.payload)&&"function"===typeof c.then){e.dispatch({type:p.f,subtype:n.type});var r=e.getState().viewChangeCounter,a=n.skipTracking;n.payload.then(function(t){var c=e.getState();(a||c.viewChangeCounter===r)&&(console.log("RESULT",t),n.payload=t,e.dispatch({type:p.e,promise:n.payload}),e.dispatch(n))},function(t){var c=e.getState();(a||c.viewChangeCounter===r)&&(console.log("ERROR",t),n.error=!0,n.payload=t.response.body,n.skipTracking||e.dispatch({type:p.e,promise:n.payload}),e.dispatch(n))})}else{var c;t(n)}}}},m=function(e){return function(e){return function(t){t.type===p.k?t.error||(window.localStorage.setItem("jwt",t.payload.user.token),l.a.setToken(t.payload.user.token)):t.type===p.m&&(window.localStorage.setItem("jwt",""),l.a.setToken(null)),e(t)}}};var f,h=n(4),v={appName:"Captain",token:null},E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case p.d:return Object(h.a)({},e,{token:t.token||null,appLoaded:!0,currentUser:t.payload?t.payload.user:null,redirectTo:t.token?null:"/login"});case p.n:return Object(h.a)({},e,{redirectTo:null});case p.k:return Object(h.a)({},e,{redirectTo:t.error?null:"/",token:t.error?null:t.payload.user.token,currentUser:t.error?null:t.payload.user});case p.h:return Object(h.a)({},e,{vessels:t.payload[0]});case p.a:return Object(h.a)({},e,{redirectTo:t.error?null:"/"});case p.m:return Object(h.a)({},e,{redirectTo:"/",token:null,currentUser:null});default:return e}},b=n(16),y={password:""},O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case p.l:return{};case p.k:return Object(h.a)({},e,{inProgress:!1,errors:t.error?t.payload.errors:null});case p.f:if(t.subtype===p.k)return Object(h.a)({},e,{inProgress:!0});break;case p.o:return Object(h.a)({},e,Object(b.a)({},t.key,t.value));default:return e}return e},g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case p.j:return Object(h.a)({},e,{vessel:t.payload[0],certificates:t.payload[1]});case p.i:return{};default:return e}},j=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(arguments.length>1?arguments[1]:void 0).type,e},k={},T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case p.b:return Object(h.a)({},e,{vessels:t.payload[0]});case p.p:return Object(h.a)({},e,Object(b.a)({},t.key,t.value));case p.a:return{inProgress:!1,errors:t.error?t.payload.errors:null};case p.f:return t.subtype===p.a?Object(h.a)({},e,{inProgress:!0}):e;case p.c:return{};default:return e}},A=n(15),N=n(32),D=n(8),U=Object(D.a)(),w=Object(N.a)(U),C=Object(s.createStore)((f=U,Object(s.combineReducers)({common:E,auth:O,home:g,vessels:j,certificate:T,router:Object(A.b)(f)})),Object(i.composeWithDevTools)(Object(s.applyMiddleware)(w,d,m))),_=n(9),L=n(20),I=n(21),P=n(23),S=n(22),R=n(24),G=n(11),F=u.a.memo(function(e){return e.currentUser?null:u.a.createElement("ul",{className:"nav navbar-nav pull-xs-right"},u.a.createElement("li",{className:"nav-item"},u.a.createElement(G.a,{to:"/",className:"nav-link"},"Home")),u.a.createElement("li",{className:"nav-item"},u.a.createElement(G.a,{to:"/login",className:"nav-link"},"Sign in")))}),H=u.a.memo(function(e){return e.currentUser?u.a.createElement("ul",{className:"nav navbar-nav pull-xs-right"},u.a.createElement("li",{className:"nav-item"},u.a.createElement(G.a,{to:"/",className:"nav-link"},"Home")),u.a.createElement("li",{className:"nav-item"},u.a.createElement(G.a,{to:"/certificate/add",className:"nav-link"},u.a.createElement("i",{className:"ion-gear-a"}),"\xa0Add Certificate")),u.a.createElement("li",{className:"nav-item"},u.a.createElement(G.a,{to:"/@".concat(e.currentUser.username),className:"nav-link"},u.a.createElement("img",{src:e.currentUser.image,className:"user-pic",alt:e.currentUser.username}),"Welcome, ",e.currentUser.display_name))):null}),z=function(e){function t(){return Object(L.a)(this,t),Object(P.a)(this,Object(S.a)(t).apply(this,arguments))}return Object(R.a)(t,e),Object(I.a)(t,[{key:"render",value:function(){return u.a.createElement("nav",{className:"navbar navbar-light"},u.a.createElement("div",{className:"container"},u.a.createElement(G.a,{to:"/",className:"navbar-brand"},this.props.appName.toLowerCase()),u.a.createElement(F,{currentUser:this.props.currentUser}),u.a.createElement(H,{currentUser:this.props.currentUser})))}}]),t}(u.a.PureComponent),x=n(5),M=Object(o.lazy)(function(){return n.e(0).then(n.bind(null,63))}),B=Object(o.lazy)(function(){return n.e(1).then(n.bind(null,64))}),V=Object(o.lazy)(function(){return n.e(2).then(n.bind(null,65))}),J=Object(o.lazy)(function(){return n.e(6).then(n.bind(null,66))}),W=function(e){function t(){return Object(L.a)(this,t),Object(P.a)(this,Object(S.a)(t).apply(this,arguments))}return Object(R.a)(t,e),Object(I.a)(t,[{key:"componentDidUpdate",value:function(e){this.props.redirectTo&&this.props.redirectTo!==e.redirectTo&&(C.dispatch(Object(x.d)(this.props.redirectTo)),this.props.onRedirect())}},{key:"componentDidMount",value:function(){var e=window.localStorage.getItem("jwt");e&&l.a.setToken(e),this.props.onLoad(e?l.a.Auth.current():null,e)}},{key:"render",value:function(){return this.props.appLoaded?u.a.createElement("div",null,u.a.createElement(z,{appName:this.props.appName,currentUser:this.props.currentUser}),u.a.createElement(o.Suspense,{fallback:u.a.createElement("p",null,"Loading...")},u.a.createElement(_.c,null,u.a.createElement(_.a,{exact:!0,path:"/",component:M}),u.a.createElement(_.a,{path:"/login",component:B}),u.a.createElement(_.a,{path:"/vessel/:id",component:V}),u.a.createElement(_.a,{path:"/certificate/add",component:J})))):u.a.createElement("div",null,u.a.createElement(z,{appName:this.props.appName,currentUser:this.props.currentUser}))}}]),t}(u.a.PureComponent),Y=Object(c.c)(function(e){return{appLoaded:e.common.appLoaded,appName:e.common.appName,currentUser:e.common.currentUser,redirectTo:e.common.redirectTo}},function(e){return{onLoad:function(t,n){return e({type:p.d,payload:t,token:n,skipTracking:!0})},onRedirect:function(){return e({type:p.n})}}})(W);a.a.render(u.a.createElement(c.a,{store:C},u.a.createElement(A.a,{history:U},u.a.createElement(_.c,null,u.a.createElement(_.a,{path:"/",component:Y})))),document.getElementById("root"))}},[[38,4,5]],[1,2]]);
//# sourceMappingURL=main.f0a8969f.chunk.js.map